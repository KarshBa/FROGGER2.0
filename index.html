<!--
  Classic “Frogger” - single-file HTML5 clone
  - Built for learning: all logic is plain ES-6 JavaScript with clear inline comments
  - Works with keyboard on desktop and an on-screen D-pad on mobile (< 360 px wide)
  - Responsive: the 15 × 13 tile canvas scales to the available viewport while
    maintaining aspect ratio.
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Frogger Clone</title>

<style>
  /* --- Layout & typography ---------------------------------------------- */
  html,body{
    margin:0;
    height:100%;
    width:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-family:Arial, sans-serif;
    background:#222;
    color:#fff;
  }
  #wrapper{display:flex;flex-direction:column;align-items:center;}

  /* --- Canvas ------------------------------------------------------------ */
  canvas{
    background:#000;                /* we paint everything, but black avoids flash */
    width:100%;                     /* fluid width … */
    max-width:750px;                /* … but never exceed original pixels           */
    height:auto;
    touch-action:none;              /* stop double-tap zoom on mobile               */
  }

  /* --- UI buttons -------------------------------------------------------- */
  .controls{display:flex;gap:10px;margin-top:8px;flex-wrap:wrap;justify-content:center;}
  button{
    font-size:16px;padding:10px 20px;border:none;border-radius:6px;
    background:#444;color:#fff;user-select:none;
  }

  /* --- Mobile D-pad ------------------------------------------------------ */
  .dpad{
    display:grid;
    grid-template-areas:
      ". up ."
      "left center right"
      ". down .";
    grid-gap:6px;margin-top:10px;justify-items:center;
  }
  .dpad button{width:60px;height:60px;}
  .dpad .up   {grid-area:up;}
  .dpad .down {grid-area:down;}
  .dpad .left {grid-area:left;}
  .dpad .right{grid-area:right;}
  .dpad .center{grid-area:center;visibility:hidden;}

  /* hide the touch pad on larger screens where a keyboard is available */
  @media (min-width:600px){ .dpad{display:none;} }
</style>
</head>
<body>
<div id="wrapper">
  <canvas id="gameCanvas" width="750" height="650"></canvas>

  <div class="controls">
    <button id="pauseBtn">Pause</button>
    <button id="restartBtn">Restart</button>
  </div>

  <!-- on-screen arrow keys (touch only) -->
  <div class="dpad">
    <button class="up">▲</button>
    <button class="left">◀</button><button class="center"></button><button class="right">▶</button>
    <button class="down">▼</button>
  </div>
</div>

<!-- tiny PCM blips (0.1 s sine) encoded as data-URIs ---------------------->
<audio id="audio-hop"    src="data:audio/wav;base64,UklGRtQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YbQAAAAA/////wD///8A////AP///wD///8A////AP///wD///8A" preload="auto"></audio>
<audio id="audio-splash" src="data:audio/wav;base64,UklGRtQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YbQAAAAA8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw" preload="auto"></audio>
<audio id="audio-honk"   src="data:audio/wav;base64,UklGRtQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YbQAAAAAmpqamqampqamqampqamqampqamqampqamqamqa" preload="auto"></audio>

<script>
/* -------------------------------------------------------------------------
   GLOBAL CONSTANTS
   --------------------------------------------------------------------- */
const TILE   = 50;          // each grid square is 50 × 50 px
const COLS   = 15;          // 15 columns → 750 px wide
const ROWS   = 13;          // 13 rows   → 650 px high
const CAN_W  = COLS * TILE; // 750
const CAN_H  = ROWS * TILE; // 650

/* -------------------------------------------------------------------------
   HELPER: simple AABB collision test, with optional padding for fairness
   --------------------------------------------------------------------- */
function intersects(ax, ay, aw, ah, bx, by, bw, bh, pad=0){
  return ax+pad < bx+bw-pad &&
         ax+aw-pad > bx+pad &&
         ay+pad < by+bh-pad &&
         ay+ah-pad > by+pad;
}

/* -------------------------------------------------------------------------
   CLASS: Player (the frog)
   --------------------------------------------------------------------- */
class Player{
  constructor(game){
    this.game = game;
    this.w = this.h = TILE;
    this.reset();
  }
  reset(){
    this.col = 7;              // middle column
    this.row = 7;              // start row (grass before water)
    this.x   = this.col*TILE;
    this.y   = this.row*TILE;
  }
  /* move by grid delta (called by InputHandler) */
  move(dx, dy){
    if(this.game.state!=="playing") return;
    const nc = this.col + dx, nr = this.row + dy;
    if(nc>=0 && nc<COLS && nr>=0 && nr<ROWS){
      this.col = nc; this.row = nr;
      this.x = this.col*TILE;
      this.y = this.row*TILE;
      this.game.playSound("hop");
    }
  }
  update(dt){
    /* If on a log, drift along with it */
    if(this.row>=8 && this.row<=12){
      const log = this.game.logs.find(l =>
        this.x+this.w/2 > l.x && this.x+this.w/2 < l.x+l.w &&
        Math.abs(this.y - l.y) < 2
      );
      if(log){
        this.x += log.speed * dt;
        this.col = Math.round(this.x / TILE);
      }
    }
  }
  draw(ctx){
    /* simple green circle frog */
    ctx.fillStyle = "#00e000";
    ctx.beginPath();
    ctx.arc(this.x+TILE/2, this.y+TILE/2, 20, 0, Math.PI*2);
    ctx.fill();
  }
}

/* -------------------------------------------------------------------------
   CLASS: Vehicle (cars & trucks)
   --------------------------------------------------------------------- */
class Vehicle{
  constructor(game, x, row, width, speed){
    this.game = game;
    this.x    = x;
    this.y    = row*TILE;
    this.row  = row;
    this.w    = width;
    this.h    = TILE-4;  // small gap between lanes
    this.speed= speed;   // px/sec (+→right, −→left)
  }
  update(dt){
    this.x += this.speed*dt;
    if(this.speed>0 && this.x>CAN_W)   this.x = -this.w;
    if(this.speed<0 && this.x<-this.w) this.x = CAN_W;
  }
  draw(ctx){
    ctx.fillStyle = "#ff5050";
    ctx.fillRect(this.x, this.y, this.w, this.h);
  }
}

/* -------------------------------------------------------------------------
   CLASS: Log (and the occasional crocodile)
   --------------------------------------------------------------------- */
class Log{
  constructor(game, x, row, width, speed){
    this.game = game;
    this.x = x;
    this.y = row*TILE;
    this.row = row;
    this.w = width;
    this.h = TILE-4;
    this.speed = speed;
    this.hasCroc = Math.random()<0.15; // 15 % chance
  }
  update(dt){
    this.x += this.speed*dt;
    if(this.speed>0 && this.x>CAN_W)   this.x = -this.w;
    if(this.speed<0 && this.x<-this.w) this.x = CAN_W;
  }
  draw(ctx){
    ctx.fillStyle = "#8b4513";
    ctx.fillRect(this.x, this.y, this.w, this.h);
    /* draw the croc as a cyan rectangle riding the log */
    if(this.hasCroc){
      ctx.fillStyle = "#22dddd";
      ctx.fillRect(this.x+this.w/2-15, this.y+6, 30, this.h-12);
    }
  }
}

/* -------------------------------------------------------------------------
   CLASS: InputHandler – keyboard & touch
   --------------------------------------------------------------------- */
class InputHandler{
  constructor(game){
    this.game = game;

    /* keyboard ----------------------------------------------------------- */
    window.addEventListener("keydown", e=>{
      if(e.repeat) return;
      switch(e.key){
        case "ArrowUp"   : game.player.move(0,-1); break;
        case "ArrowDown" : game.player.move(0, 1); break;
        case "ArrowLeft" : game.player.move(-1,0); break;
        case "ArrowRight": game.player.move( 1,0); break;
        case "p":
        case "P"         : game.togglePause();     break;
      }
    });

    /* on-screen d-pad ---------------------------------------------------- */
    const map = {up:[0,-1], down:[0,1], left:[-1,0], right:[1,0]};
    document.querySelectorAll(".dpad button").forEach(btn=>{
      btn.addEventListener("touchstart", e=>{
        e.preventDefault();                     // stop scrolling
        for(const dir in map){
          if(btn.classList.contains(dir)){
            game.player.move(...map[dir]);
            break;
          }
        }
      });
    });

    /* Pause / Restart buttons ------------------------------------------- */
    document.getElementById("pauseBtn")
            .addEventListener("click", ()=>game.togglePause());
    document.getElementById("restartBtn")
            .addEventListener("click", ()=>location.reload());
  }
}

/* -------------------------------------------------------------------------
   CLASS: Game – the core orchestrator
   --------------------------------------------------------------------- */
class Game{
  constructor(ctx){
    this.ctx   = ctx;
    this.level = 1;
    this.score = 0;
    this.high  = +localStorage.getItem("froggerHighScore")||0;
    this.lives = 3;
    this.time  = 60;          // seconds per round
    this.state = "playing";   // paused | gameover
    this.player = new Player(this);
    this.vehicles = [];
    this.logs     = [];
    this.homes    = Array(5).fill(false); // lily-pad occupancy
    this.configureLanes();

    /* set a 1 s countdown timer ----------------------------------------- */
    this._timer = setInterval(()=>{
      if(this.state==="playing"){
        this.time--;
        if(this.time<=0) this.loseLife();
      }
    },1000);

    /* begin main loop ---------------------------------------------------- */
    this.last = performance.now();
    requestAnimationFrame(this.loop.bind(this));
  }

  /* build cars + logs for current level --------------------------------- */
  configureLanes(){
    this.vehicles.length = 0;
    this.logs.length     = 0;

    /* road lanes (rows 2-6) --------------------------------------------- */
    for(let r=2;r<=6;r++){
      const dir   = (r%2?1:-1); // alternate directions
      const speed = (100 + 20*this.level) * dir;
      for(let i=0;i<3;i++){
        const w = 80 + Math.random()*60;        // varied car widths
        const x = Math.random()*CAN_W;
        this.vehicles.push(new Vehicle(this,x,r,w,speed));
      }
    }

    /* river lanes (rows 8-12) ------------------------------------------- */
    for(let r=8;r<=12;r++){
      const dir   = (r%2?-1:1);
      const speed = (80 + 10*this.level) * dir;
      for(let i=0;i<2;i++){
        const x = Math.random()*CAN_W;
        this.logs.push(new Log(this,x,r,120,speed));
      }
    }
  }

  /* main update-draw loop ----------------------------------------------- */
  loop(ts){
    const dt = (ts-this.last)/1000; // delta-time in seconds
    this.last = ts;

    this.update(dt);
    this.draw();

    requestAnimationFrame(this.loop.bind(this));
  }

  /* update world -------------------------------------------------------- */
  update(dt){
    if(this.state!=="playing") return;

    this.vehicles.forEach(v=>v.update(dt));
    this.logs    .forEach(l=>l.update(dt));
    this.player.update(dt);

    this.checkCollisions();
  }

  /* draw everything ----------------------------------------------------- */
  draw(){
    /* clear canvas */
    this.ctx.clearRect(0,0,CAN_W,CAN_H);

    /* background stripes: grass, road, river ---------------------------- */
    this.ctx.fillStyle="#116611";               // home grass
    this.ctx.fillRect(0,0,CAN_W,TILE);
    this.ctx.fillStyle="#333";
    this.ctx.fillRect(0,2*TILE,CAN_W,5*TILE);   // road
    this.ctx.fillStyle="#116611";
    this.ctx.fillRect(0,7*TILE,CAN_W,TILE);     // middle grass
    this.ctx.fillStyle="#003366";
    this.ctx.fillRect(0,8*TILE,CAN_W,5*TILE);   // river

    /* lily-pads --------------------------------------------------------- */
    for(let i=0;i<5;i++){
      const padX = i*150+25;                    // 25, 175, …
      this.ctx.fillStyle = this.homes[i] ? "#88ff88" : "#00aa00";
      this.ctx.beginPath();
      this.ctx.arc(padX, TILE/2, 20, 0, Math.PI*2);
      this.ctx.fill();
    }

    /* entities ---------------------------------------------------------- */
    this.logs    .forEach(l=>l.draw(this.ctx));
    this.vehicles.forEach(v=>v.draw(this.ctx));
    this.player.draw(this.ctx);

    /* HUD --------------------------------------------------------------- */
    this.ctx.fillStyle="#fff";
    this.ctx.font="20px Arial";
    this.ctx.textAlign="left";
    this.ctx.fillText(`Score: ${this.score}  Lives: ${this.lives}`,10,20);

    this.ctx.textAlign="right";
    this.ctx.fillText(`Time: ${this.time}`, CAN_W-10, 20);

    this.ctx.textAlign="center";
    this.ctx.fillText(`High: ${this.high}`, CAN_W/2, 20);

    /* overlay for paused / game-over ----------------------------------- */
    if(this.state!=="playing"){
      this.ctx.fillStyle="rgba(0,0,0,0.5)";
      this.ctx.fillRect(0,0,CAN_W,CAN_H);
      this.ctx.fillStyle="#fff";
      this.ctx.font="40px Arial";
      this.ctx.textAlign="center";
      this.ctx.fillText(this.state==="paused"?"PAUSED":"GAME OVER",
                        CAN_W/2, CAN_H/2);
      if(this.state==="gameover"){
        this.ctx.font="24px Arial";
        this.ctx.fillText("Tap Restart", CAN_W/2, CAN_H/2+40);
      }
    }
  }

  /* handle frog interactions ------------------------------------------- */
  checkCollisions(){
    const p = this.player;

    /* 1) road: hit a vehicle? */
    if(p.row>=2 && p.row<=6){
      if(this.vehicles.some(v=>intersects(p.x,p.y,p.w,p.h,v.x,v.y,v.w,v.h,4))){
        this.loseLife();
        this.playSound("honk");
        return;
      }
    }

    /* 2) river: must be on a log; crocodile kills too */
    if(p.row>=8 && p.row<=12){
      const safeLog = this.logs.find(l=>intersects(
        p.x,p.y,p.w,p.h,l.x,l.y,l.w,l.h,4));

      if(!safeLog || safeLog.hasCroc){
        this.loseLife();
        this.playSound("splash");
        return;
      }
    }

    /* 3) reached home row --------------------------------------------- */
    if(p.row===0){
      const idx = Math.floor(p.col/3);  // each pad spans 3 columns
      if(!this.homes[idx]){
        this.homes[idx]=true;
        this.score += 50;
        this.levelComplete();
      }else{
        /* jumped on an already-taken pad → unfair, so just lose a life */
        this.loseLife();
      }
    }
  }

  /* lose a life & reset frog ------------------------------------------- */
  loseLife(){
    this.lives--;
    if(this.lives<=0){
      this.state="gameover";
      clearInterval(this._timer);
      if(this.score>this.high){
        localStorage.setItem("froggerHighScore",this.score);
      }
    }
    this.player.reset();
    this.time = 60;
  }

  /* all five pads filled?  otherwise just reset frog ------------------- */
  levelComplete(){
    if(this.homes.every(Boolean)){
      this.level++;
      this.score += 500;
      this.configureLanes();     // faster cars/logs
      this.homes.fill(false);    // empty pads
    }
    this.player.reset();
    this.time = 60;
  }

  /* pause / resume ------------------------------------------------------ */
  togglePause(){
    if(this.state==="playing"){
      this.state="paused";
    }else if(this.state==="paused"){
      this.state="playing";
    }
  }

  /* small helper to play one of the embedded WAV blips ----------------- */
  playSound(name){
    const el = document.getElementById(`audio-${name}`);
    if(el){ el.currentTime=0; el.play(); }
  }
}

/* -----------------------------------------------------------------------
   INITIALISE EVERYTHING once DOM is ready
   --------------------------------------------------------------------- */
window.addEventListener("load", ()=>{
  const canvas = document.getElementById("gameCanvas");
  const ctx    = canvas.getContext("2d");

  const game   = new Game(ctx);
  new InputHandler(game);          // attach controls
});
</script>
</body>
</html>
